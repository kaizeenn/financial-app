<!-- Mobile Menu Toggle Button (Hidden di desktop) -->
<button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle Menu">
  <svg class="w-6 h-6" fill="none" stroke="#4f46e5" viewBox="0 0 24 24" stroke-width="2.5">
    <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
  </svg>
</button>

<!-- Sidebar Overlay (untuk close sidebar saat klik luar) -->
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<!-- Sidebar (Tailwind) -->
<!-- Fixed sidebar for predictable alignment -->
<aside class="sidebar-template fixed left-0 top-0 w-64 h-screen bg-white border-r overflow-auto z-20" id="sidebar">
  <div class="p-4 flex items-center gap-3 border-b">
    <img src="/images/template/logo/logo-icon.svg" alt="logo" class="w-9 h-9">
    <div>
      <h6 class="text-lg font-semibold">Catatan Keuangan</h6>
      <small class="text-sm text-gray-500"><%- username %></small>
    </div>
  </div>

  <nav class="p-3 space-y-1">
    <div class="text-xs text-gray-400 uppercase px-2">Menu Utama</div>
    <a href="/user/dashboard" class="flex items-center gap-3 px-3 py-2 rounded-md <%=
      active === 'dashboard' ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-100'
    %>">
      <i class="fas fa-tachometer-alt w-4"></i>
      <span class="truncate">Dashboard</span>
    </a>

    <a href="/user/transactions" class="flex items-center gap-3 px-3 py-2 rounded-md <%=
      active === 'transactions' ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-100'
    %>">
      <i class="fas fa-receipt w-4"></i>
      <span class="truncate">Transaksi</span>
    </a>
  
    <a href="/user/recurring" class="flex items-center gap-3 px-3 py-2 rounded-md <%=
      active === 'recurring' ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-100'
    %>">
      <i class="fas fa-clock w-4"></i>
      <span class="truncate">Transaksi Berulang</span>
    </a>

    <a href="/user/debts" class="flex items-center gap-3 px-3 py-2 rounded-md <%=
      active === 'debts' ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-100'
    %>">
      <i class="fas fa-hand-holding-usd w-4"></i>
      <span class="truncate">Utang & Piutang</span>
    </a>

    <a href="/user/accounts" class="flex items-center gap-3 px-3 py-2 rounded-md <%=
      active === 'accounts' ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-100'
    %>">
      <i class="fas fa-wallet w-4"></i>
      <span class="truncate">Akun</span>
    </a>

    <a href="/invest" class="flex items-center gap-3 px-3 py-2 rounded-md <%=
      active === 'invest' ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-100'
    %>">
      <i class="fas fa-chart-line w-4"></i>
      <span class="truncate">Investasi</span>
    </a>

    <a href="/user/profile" class="flex items-center gap-3 px-3 py-2 rounded-md <%=
      active === 'profile' ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-100'
    %>">
      <i class="fas fa-user w-4"></i>
      <span class="truncate">Profil</span>
    </a>

    <a href="/auth/logout" class="flex items-center gap-3 px-3 py-2 rounded-md text-red-600 hover:bg-red-50">
      <i class="fas fa-sign-out-alt w-4"></i>
      <span class="truncate">Keluar</span>
    </a>
  </nav>
</aside>

<!-- JavaScript untuk toggle sidebar di mobile -->
<script>
(function() {
  const menuToggle = document.getElementById('mobileMenuToggle');
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('sidebarOverlay');
  
  console.log('Mobile menu script loaded');
  console.log('menuToggle:', menuToggle);
  console.log('sidebar:', sidebar);
  console.log('overlay:', overlay);
  
  if (menuToggle && sidebar && overlay) {
    // Toggle sidebar saat klik button
    menuToggle.addEventListener('click', function(e) {
      e.preventDefault();
      console.log('Menu toggle clicked');
      
      const isActive = sidebar.classList.contains('active');
      console.log('Current active state:', isActive);
      
      if (isActive) {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
        console.log('Closing sidebar');
      } else {
        sidebar.classList.add('active');
        overlay.classList.add('active');
        console.log('Opening sidebar');
      }
    });
    
    // Close sidebar saat klik overlay
    overlay.addEventListener('click', function() {
      console.log('Overlay clicked - closing sidebar');
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
    });
    
    // Close sidebar saat klik link (optional)
    const sidebarLinks = sidebar.querySelectorAll('a');
    sidebarLinks.forEach(function(link) {
      link.addEventListener('click', function() {
        if (window.innerWidth <= 768) {
          console.log('Link clicked - closing sidebar');
          sidebar.classList.remove('active');
          overlay.classList.remove('active');
        }
      });
    });
    
    console.log('Mobile menu initialized successfully');
  } else {
    console.error('Mobile menu elements not found!');
  }
})();
</script>
